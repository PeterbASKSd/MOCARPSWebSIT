import Modal from 'rc-dialog';
import React, { useState } from 'react';
import mime from 'mime-types';
import { pdfjs, Document, Page } from 'react-pdf';
import { AiOutlineRotateLeft, AiOutlineRotateRight, AiOutlineDownload, AiOutlineCheck, AiOutlineShareAlt, AiOutlineClose, AiOutlineLeft, AiOutlineRight } from 'react-icons/ai';
import CopyToClipboard from 'react-copy-to-clipboard';

pdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;
const PDFViewer = ({ url }) => {
    const [numPages, setNumPages] = useState(null);
    const onDocumentLoadSuccess = ({ numPages: nextNumPages }) => {
        setNumPages(nextNumPages);
    };
    return (React.createElement(React.Fragment, null,
        React.createElement(Document, { file: url, onLoadSuccess: onDocumentLoadSuccess }, Array.from({ length: numPages }, (_, index) => (React.createElement(Page, { key: `page_${index + 1}`, pageNumber: index + 1, renderAnnotationLayer: false, renderTextLayer: false }))))));
};

const isExtInclude = (filename, extList) => {
    const dotPos = filename.lastIndexOf(".");
    if (dotPos >= 0) {
        const ext = filename.substr(dotPos);
        return extList.includes(ext.toLowerCase());
    }
    return false;
};
const wordExts = [".docx", ".doc", ".rtf", ".html", ".odt"];
const excelExts = [
    ".xlsx",
    ".xls",
    ".csv",
    ".xlsb",
    ".xlsm",
    ".xlt",
    ".xltm",
    ".xltx",
];
const pptExts = [".ppt", ".pptx"];
const isImageFile = (contentType) => {
    return contentType.startsWith("image");
};
const isAudioFile = (contentType) => {
    return contentType.startsWith("audio");
};
const isVideoFile = (contentType) => {
    return contentType.startsWith("video");
};
const isPDFFile = (contentType) => {
    return contentType.startsWith("application/pdf");
};
const isOfficeWordFile = (filename) => {
    return isExtInclude(filename, wordExts);
};
const isOfficeExcelFile = (filename) => {
    return isExtInclude(filename, excelExts);
};
const isOfficePPTFile = (filename) => {
    return isExtInclude(filename, pptExts);
};

function styleInject(css, ref) {
  if ( ref === void 0 ) ref = {};
  var insertAt = ref.insertAt;

  if (!css || typeof document === 'undefined') { return; }

  var head = document.head || document.getElementsByTagName('head')[0];
  var style = document.createElement('style');
  style.type = 'text/css';

  if (insertAt === 'top') {
    if (head.firstChild) {
      head.insertBefore(style, head.firstChild);
    } else {
      head.appendChild(style);
    }
  } else {
    head.appendChild(style);
  }

  if (style.styleSheet) {
    style.styleSheet.cssText = css;
  } else {
    style.appendChild(document.createTextNode(css));
  }
}

var css_248z$2 = ".styles-module_modalContainer__K8nSt {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n  max-width: 80vw;\n  width: auto !important;\n}\n\n.styles-module_modalWrap__1vR_r {\n  background: rgb(29 29 29 / 95%);\n  z-index: 4396;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.styles-module_mediaContainer__2mvA- {\n  max-height: 80vh;\n  height: 100%;\n  width: 100%;\n  display: block;\n  overflow: auto;\n}\n\n.styles-module_mediaContainer__2mvA- canvas {\n  max-width: 100%;\n  height: unset !important;\n}\n\n.styles-module_mediaContainer__2mvA- div {\n  left: unset !important;\n}\n\n.styles-module_docContainer__2ifN6 {\n  height: 80vh;\n  width: 650px;\n  max-width: 90vw;\n  margin: auto;\n  overflow: auto;\n}\n\n.styles-module_excelContainer__2ElAd {\n  height: 80vh;\n  width: 80vw;\n  margin: auto;\n  overflow: auto;\n}\n\n.styles-module_pptContainer__2xKz2 {\n  height: 80vh;\n  width: 60vw;\n  max-width: 80vw;\n  margin: auto;\n  overflow: auto;\n}\n";
var styles = {"modalContainer":"styles-module_modalContainer__K8nSt","modalWrap":"styles-module_modalWrap__1vR_r","mediaContainer":"styles-module_mediaContainer__2mvA-","docContainer":"styles-module_docContainer__2ifN6","excelContainer":"styles-module_excelContainer__2ElAd","pptContainer":"styles-module_pptContainer__2xKz2"};
styleInject(css_248z$2);

const PreviewModal$1 = ({ url }) => {
    const [rotate, setRotate] = useState(0);
    const type = mime.lookup(url) || "image";
    const mediaFile = () => {
        if (isImageFile(type))
            return (React.createElement(React.Fragment, null,
                React.createElement("img", { alt: "", src: url, className: "max-h-4/5 max-w-full block overflow-auto select-none", style: { transform: `rotate(${rotate}deg)` } }),
                React.createElement("div", { className: "fixed inset-x-1/2 bottom-8 flex justify-center" },
                    React.createElement("a", { className: "my-auto mx-4 bg-black rounded-full p-2" },
                        React.createElement(AiOutlineRotateLeft, { size: "1rem", className: "text-white hover:!text-red-500 cursor-pointer", onClick: () => setRotate(rotate - 90) })),
                    React.createElement("a", { className: "my-auto mx-4 bg-black rounded-full p-2" },
                        React.createElement(AiOutlineRotateRight, { size: "1rem", className: "text-white hover:!text-red-500 cursor-pointer", onClick: () => setRotate(rotate + 90) })))));
        if (isPDFFile(type))
            return (React.createElement("div", { className: styles.mediaContainer },
                React.createElement(PDFViewer, { url: url })));
        if (isOfficeWordFile(url))
            return (React.createElement("iframe", { className: styles.docContainer, src: `https://view.officeapps.live.com/op/embed.aspx?src=${url}` }));
        if (isOfficePPTFile(url))
            return (React.createElement("iframe", { className: styles.pptContainer, src: `https://view.officeapps.live.com/op/embed.aspx?src=${url}` }));
        if (isOfficeExcelFile(url))
            return (React.createElement("iframe", { className: styles.excelContainer, src: `https://view.officeapps.live.com/op/embed.aspx?src=${url}` }));
        if (isVideoFile(type) || isAudioFile(type))
            return (React.createElement("video", { src: url, controls: true, className: styles.mediaContainer },
                React.createElement("track", { kind: "captions" })));
        return (React.createElement("div", { className: "flex items-center justify-center text-white text-lg" }, "Unable to preview this unknown file"));
    };
    return mediaFile();
};

const PreviewModal = ({ visible, setVisible, urls }) => {
    const [copyed, setCopyed] = useState(false);
    const [index, setIndex] = useState(0);
    const currentUrl = urls[index];
    return (React.createElement(Modal, { visible: visible, onClose: () => setVisible(false), footer: null, zIndex: 10000, destroyOnClose: true, closable: false, maskClosable: false, className: styles.modalContainer, wrapClassName: styles.modalWrap, transitionName: "", maskTransitionName: "" },
        React.createElement("div", { className: "flex w-full items-center justify-end fixed top-6 right-4" },
            React.createElement("div", { className: "flex" },
                React.createElement("a", { href: `${currentUrl}?download/${currentUrl.split("/").pop()}`, className: "my-auto mx-4 bg-black rounded-full p-2" },
                    React.createElement(AiOutlineDownload, { size: "1.5rem", className: "text-white hover:!text-red-500 cursor-pointer" })),
                React.createElement(CopyToClipboard, { text: currentUrl, onCopy: () => {
                        setCopyed(true);
                        setTimeout(() => {
                            setCopyed(false);
                        }, 2000);
                    } },
                    React.createElement("a", { className: "my-auto mx-4 bg-black rounded-full p-2" }, copyed ? (React.createElement(AiOutlineCheck, { size: "1.5rem", className: "text-white hover:!text-red-500 cursor-pointer" })) : (React.createElement(AiOutlineShareAlt, { size: "1.5rem", className: "text-white hover:!text-red-500 cursor-pointer" })))),
                React.createElement("a", { className: "my-auto mx-4 bg-black rounded-full p-2" },
                    React.createElement(AiOutlineClose, { size: "1.5rem", className: "text-white hover:!text-red-500 cursor-pointer", onClick: () => setVisible(false) })))),
        React.createElement(PreviewModal$1, { url: currentUrl }),
        React.createElement("a", { className: `my-auto mx-4 bg-black rounded-full p-3 fixed md:top-1/2 md:bottom-auto left-2 sm:bottom-8 sm:top-auto ${index === 0 ? "hidden" : "block"}`, onClick: () => {
                setIndex(index - 1);
            } },
            React.createElement(AiOutlineLeft, { size: "2rem", className: "text-white hover:!text-red-500 cursor-pointer" })),
        React.createElement("a", { className: `my-auto mx-4 bg-black rounded-full p-3 fixed md:top-1/2 md:bottom-auto right-2 sm:bottom-8 sm:top-auto ${index + 1 === urls.length ? "hidden" : "block"}`, onClick: () => {
                setIndex(index + 1);
            } },
            React.createElement(AiOutlineRight, { size: "2rem", className: "text-white hover:!text-red-500 cursor-pointer" }))));
};

var css_248z$1 = "img {\n  max-width: 100%;\n}\n\nsvg,\nvideo {\n  display: block !important;\n}\n\n.rc-dialog {\n  position: relative;\n  width: auto;\n  margin: 10px;\n}\n\n.rc-dialog-wrap {\n  position: fixed;\n  overflow: auto;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 1050;\n  -webkit-overflow-scrolling: touch;\n  outline: 0;\n}\n\n.rc-dialog-content {\n  position: relative;\n  border: none;\n  border-radius: 6px;\n  background-clip: padding-box;\n}\n\n.rc-dialog-body {\n  padding: 0;\n}\n\n@media (min-width: 768px) {\n  .rc-dialog {\n    width: 600px;\n    margin: 30px auto;\n  }\n}\n\n.rc-dialog-mask {\n  position: fixed;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  background-color: #373737;\n  background-color: rgb(55 55 55 / 60%);\n  height: 100%;\n  z-index: 1050;\n}\n\n.rc-dialog-mask-hidden {\n  display: none;\n}\n";
styleInject(css_248z$1);

var css_248z = "*, ::before, ::after {\n    --tw-border-spacing-x: 0;\n    --tw-border-spacing-y: 0;\n    --tw-translate-x: 0;\n    --tw-translate-y: 0;\n    --tw-rotate: 0;\n    --tw-skew-x: 0;\n    --tw-skew-y: 0;\n    --tw-scale-x: 1;\n    --tw-scale-y: 1;\n    --tw-pan-x:  ;\n    --tw-pan-y:  ;\n    --tw-pinch-zoom:  ;\n    --tw-scroll-snap-strictness: proximity;\n    --tw-ordinal:  ;\n    --tw-slashed-zero:  ;\n    --tw-numeric-figure:  ;\n    --tw-numeric-spacing:  ;\n    --tw-numeric-fraction:  ;\n    --tw-ring-inset:  ;\n    --tw-ring-offset-width: 0px;\n    --tw-ring-offset-color: #fff;\n    --tw-ring-color: rgb(59 130 246 / 0.5);\n    --tw-ring-offset-shadow: 0 0 #0000;\n    --tw-ring-shadow: 0 0 #0000;\n    --tw-shadow: 0 0 #0000;\n    --tw-shadow-colored: 0 0 #0000;\n    --tw-blur:  ;\n    --tw-brightness:  ;\n    --tw-contrast:  ;\n    --tw-grayscale:  ;\n    --tw-hue-rotate:  ;\n    --tw-invert:  ;\n    --tw-saturate:  ;\n    --tw-sepia:  ;\n    --tw-drop-shadow:  ;\n    --tw-backdrop-blur:  ;\n    --tw-backdrop-brightness:  ;\n    --tw-backdrop-contrast:  ;\n    --tw-backdrop-grayscale:  ;\n    --tw-backdrop-hue-rotate:  ;\n    --tw-backdrop-invert:  ;\n    --tw-backdrop-opacity:  ;\n    --tw-backdrop-saturate:  ;\n    --tw-backdrop-sepia:  \n}\n::-webkit-backdrop {\n    --tw-border-spacing-x: 0;\n    --tw-border-spacing-y: 0;\n    --tw-translate-x: 0;\n    --tw-translate-y: 0;\n    --tw-rotate: 0;\n    --tw-skew-x: 0;\n    --tw-skew-y: 0;\n    --tw-scale-x: 1;\n    --tw-scale-y: 1;\n    --tw-pan-x:  ;\n    --tw-pan-y:  ;\n    --tw-pinch-zoom:  ;\n    --tw-scroll-snap-strictness: proximity;\n    --tw-ordinal:  ;\n    --tw-slashed-zero:  ;\n    --tw-numeric-figure:  ;\n    --tw-numeric-spacing:  ;\n    --tw-numeric-fraction:  ;\n    --tw-ring-inset:  ;\n    --tw-ring-offset-width: 0px;\n    --tw-ring-offset-color: #fff;\n    --tw-ring-color: rgb(59 130 246 / 0.5);\n    --tw-ring-offset-shadow: 0 0 #0000;\n    --tw-ring-shadow: 0 0 #0000;\n    --tw-shadow: 0 0 #0000;\n    --tw-shadow-colored: 0 0 #0000;\n    --tw-blur:  ;\n    --tw-brightness:  ;\n    --tw-contrast:  ;\n    --tw-grayscale:  ;\n    --tw-hue-rotate:  ;\n    --tw-invert:  ;\n    --tw-saturate:  ;\n    --tw-sepia:  ;\n    --tw-drop-shadow:  ;\n    --tw-backdrop-blur:  ;\n    --tw-backdrop-brightness:  ;\n    --tw-backdrop-contrast:  ;\n    --tw-backdrop-grayscale:  ;\n    --tw-backdrop-hue-rotate:  ;\n    --tw-backdrop-invert:  ;\n    --tw-backdrop-opacity:  ;\n    --tw-backdrop-saturate:  ;\n    --tw-backdrop-sepia:  \n}\n::backdrop {\n    --tw-border-spacing-x: 0;\n    --tw-border-spacing-y: 0;\n    --tw-translate-x: 0;\n    --tw-translate-y: 0;\n    --tw-rotate: 0;\n    --tw-skew-x: 0;\n    --tw-skew-y: 0;\n    --tw-scale-x: 1;\n    --tw-scale-y: 1;\n    --tw-pan-x:  ;\n    --tw-pan-y:  ;\n    --tw-pinch-zoom:  ;\n    --tw-scroll-snap-strictness: proximity;\n    --tw-ordinal:  ;\n    --tw-slashed-zero:  ;\n    --tw-numeric-figure:  ;\n    --tw-numeric-spacing:  ;\n    --tw-numeric-fraction:  ;\n    --tw-ring-inset:  ;\n    --tw-ring-offset-width: 0px;\n    --tw-ring-offset-color: #fff;\n    --tw-ring-color: rgb(59 130 246 / 0.5);\n    --tw-ring-offset-shadow: 0 0 #0000;\n    --tw-ring-shadow: 0 0 #0000;\n    --tw-shadow: 0 0 #0000;\n    --tw-shadow-colored: 0 0 #0000;\n    --tw-blur:  ;\n    --tw-brightness:  ;\n    --tw-contrast:  ;\n    --tw-grayscale:  ;\n    --tw-hue-rotate:  ;\n    --tw-invert:  ;\n    --tw-saturate:  ;\n    --tw-sepia:  ;\n    --tw-drop-shadow:  ;\n    --tw-backdrop-blur:  ;\n    --tw-backdrop-brightness:  ;\n    --tw-backdrop-contrast:  ;\n    --tw-backdrop-grayscale:  ;\n    --tw-backdrop-hue-rotate:  ;\n    --tw-backdrop-invert:  ;\n    --tw-backdrop-opacity:  ;\n    --tw-backdrop-saturate:  ;\n    --tw-backdrop-sepia:  \n}\n.visible {\n    visibility: visible\n}\n.fixed {\n    position: fixed\n}\n.inset-x-1\\/2 {\n    left: 50%;\n    right: 50%\n}\n.bottom-8 {\n    bottom: 2rem\n}\n.top-6 {\n    top: 1.5rem\n}\n.right-4 {\n    right: 1rem\n}\n.left-2 {\n    left: 0.5rem\n}\n.right-2 {\n    right: 0.5rem\n}\n.my-auto {\n    margin-top: auto;\n    margin-bottom: auto\n}\n.mx-4 {\n    margin-left: 1rem;\n    margin-right: 1rem\n}\n.block {\n    display: block\n}\n.flex {\n    display: flex\n}\n.hidden {\n    display: none\n}\n.max-h-4\\/5 {\n    max-height: 80vh\n}\n.w-full {\n    width: 100%\n}\n.max-w-full {\n    max-width: 100%\n}\n.transform {\n    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))\n}\n.cursor-pointer {\n    cursor: pointer\n}\n.select-none {\n    -webkit-user-select: none;\n       -moz-user-select: none;\n            user-select: none\n}\n.items-center {\n    align-items: center\n}\n.justify-end {\n    justify-content: flex-end\n}\n.justify-center {\n    justify-content: center\n}\n.overflow-auto {\n    overflow: auto\n}\n.rounded-full {\n    border-radius: 9999px\n}\n.bg-black {\n    --tw-bg-opacity: 1;\n    background-color: rgb(0 0 0 / var(--tw-bg-opacity))\n}\n.p-2 {\n    padding: 0.5rem\n}\n.p-3 {\n    padding: 0.75rem\n}\n.text-lg {\n    font-size: 1.125rem;\n    line-height: 1.75rem\n}\n.text-white {\n    --tw-text-opacity: 1;\n    color: rgb(255 255 255 / var(--tw-text-opacity))\n}\n.hover\\:\\!text-red-500:hover {\n    --tw-text-opacity: 1 !important;\n    color: rgb(239 68 68 / var(--tw-text-opacity)) !important\n}\n@media (min-width: 640px) {\n    .sm\\:bottom-8 {\n        bottom: 2rem\n    }\n    .sm\\:top-auto {\n        top: auto\n    }\n}\n@media (min-width: 768px) {\n    .md\\:top-1\\/2 {\n        top: 50%\n    }\n    .md\\:bottom-auto {\n        bottom: auto\n    }\n}\n";
styleInject(css_248z);

export default PreviewModal;
//# sourceMappingURL=index.esm.js.map
